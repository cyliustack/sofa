#!/bin/sh
function print_help()
{
    echo "$0 [OPTIONS, ...] command [command args...]"
    echo "    OPTIONS: None"
}

options=""
configFile="default.cfg"
while [[ 1 ]]; do
    case "$1" in
        "--help" )
            print_help
            exit 0
            ;;
        "-h" )
            print_help
            exit 0
            ;;
        "--config" )
            shift 
            configFile=$1
            ;;
        *)
            break
            ;;
    esac
    shift 1 # Remove the fisrt argument
done
args=$*
rm -f perf.data
#Communication Traces
tcpdump -w sofa.pcap & 
#Computation Traces
perf record -F 99 -a ${args} && pkill tcpdump
perf script > perf.script
echo "FSA Configuration File: ${configFile}"
echo "script source = $(dirname $0)"
$(dirname $0)/fsa ${configFile}
